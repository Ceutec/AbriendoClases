<h1>Listado de propuestas</h1>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Horario</th>
      <th>Estado</th>
      <th>Registrados</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @requests.each do |request| %>
      <tr>
        <td><%= request.course.name %></td>
        <td><%= request.schedule.name %></td>
        <td><%= request.state.name %></td>
        <td><%= UserInRequest.where(:request_id => request.id).count %></td>
        <td><%= link_to 'Mostrar', request %></td>
				<% if userIsCoordinator %>
        	<td><%= link_to 'Editar', edit_request_path(request) %></td>
	        <td><%= link_to 'Borrar', request, method: :delete, data: { confirm: 'Â¿Borrar propuesta?' } %></td>
				<% end %>
        <% if UserInRequest.where(:user_id => current_user.id, :request_id =>request.id).count == 0 %>
          <td><%= link_to 'Registrarme', '/requests/registrarme?request_id='+request.id.to_s %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'Nueva propuesta', new_request_path %>
